@model LogisticsQuoteModel
@using Nop.Core.Domain.Catalog
@using Nop.Services

<div class="card-body">
    @if (Model.Id > 0)
    {
        @await Html.PartialAsync("Table", new DataTablesModel
        {
            Name = "logisticsQuoteOrderFollowupsInfos-grid",
            UrlRead = new DataUrl("LogisticsQuoteOrderFollowupsInfoList", "LogisticsQuote", new RouteValueDictionary { [nameof(Model.LogisticsQuoteOrderFollowupsInfoSearchModel.LeadId)] = Model.LeadId }),
            //UrlDelete = new DataUrl("LogisticsQuoteOrderFollowupsInfoDelete", "LogisticsQuote", null),
            Length = Model.LogisticsQuoteOrderFollowupsInfoSearchModel.PageSize,
            LengthMenu = Model.LogisticsQuoteOrderFollowupsInfoSearchModel.AvailablePageSizes,
            ColumnCollection = new List<ColumnProperty>
            {
                new ColumnProperty(nameof(LogisticsQuoteOrderFollowupsInfoModel.FollowUpType))
                {
                    Title = T("Admin.LogisticsQuoteOrderFollowupsInfo.Fields.FollowUpType").Text
                },
                new ColumnProperty(nameof(LogisticsQuoteOrderFollowupsInfoModel.Note))
                {
                    Title = T("Admin.LogisticsQuoteOrderFollowupsInfo.Fields.Notes").Text
                },
                new ColumnProperty(nameof(LogisticsQuoteOrderFollowupsInfoModel.FollowupOn))
                {
                    Title = T("Admin.LogisticsQuoteOrderFollowupsInfo.Fields.FollowupDate").Text,
                    Width = "120",
                    Render = new RenderDate()
                },
                new ColumnProperty(nameof(LogisticsQuoteOrderFollowupsInfoModel.Completed))
                {
                    Title = T("Admin.LogisticsQuoteOrderFollowupsInfo.Fields.Completed").Text,
                    Width = "70",
                    ClassName = NopColumnClassDefaults.CenterAll,
                    Render = new RenderBoolean()
                },
                new ColumnProperty(nameof(LogisticsQuoteOrderFollowupsInfoModel.Id))
                {
                    Title = T("Admin.Common.Delete").Text,
                    Width = "100",
                    Render = new RenderCustom("renderColumnFollowupsDelete"),
                    ClassName =  NopColumnClassDefaults.Button
                }
            }
        })

        <div class="card-footer">
            <button type="submit" id="btnAddNewLogisticsQuoteOrderFollowupsInfo" onclick="javascript:OpenWindow('@(Url.Action("LogisticsQuoteOrderFollowupsInfoCreatePopup", "LogisticsQuote", new { leadId = Model.LeadId, btnId = "btnRefreshlogisticsQuoteOrderFollowupsInfos", formId = "quote-form"}))', 800, 600, true); return false;" class="btn btn-primary">
                <i class="fa fa-plus"></i>Follow-up
            </button>
            <button type="submit" id="btnRefreshlogisticsQuoteOrderFollowupsInfos" style="display: none"></button>
            <script>
                $(document).ready(function () {
                    $('#btnRefreshlogisticsQuoteOrderFollowupsInfos').click(function () {
                        updateTable('#logisticsQuoteOrderFollowupsInfos-grid');
                        //return false to don't reload a page
                        return false;
                    });
                });
            </script>
        </div>
    }
    else
    {
        @T("Admin.LogisticsOrderFollowupsInfo.SaveBeforeEdit")
    }
</div>


<div id="followUp-delete-confirmation" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="followUp-delete-confirmation-title" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="followUpdelete-confirmation-title">@T("Admin.Common.AreYouSure")</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
            </div>
            <div class="form-horizontal">
                <div class="modal-body">
                    @T("Admin.Common.DeleteConfirmation")
                </div>
                <div class="modal-footer">
                    <span class="btn btn-default" data-dismiss="modal">@T("Admin.Common.NoCancel")</span>
                    <button type="submit" class="btn btn-danger float-right">@T("Admin.Common.Delete")</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    $("#logisticsQuoteOrderFollowupsInfos-grid")
        .on("click", ".delete-followUp-link", function (e) {
            $("#followUp-delete-confirmation button[type=submit]").attr("name", $(this).attr("name"));
        });
</script>
<script asp-location="Footer">
    function renderColumnFollowupsDelete(data, type, row, meta) {
        return '<td class=\"  button-column\"><a name="delete-followUp-link-' + data + '" class="btn btn-default delete-followUp-link" data-toggle="modal" data-target="#followUp-delete-confirmation"><i class="far fa-trash-alt"></i>Delete</a></td>';
    }
</script>
